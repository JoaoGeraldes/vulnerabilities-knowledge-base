---
layout: page  
---
{% assign score = page.cvss-score %}

{% assign owasp10_map = page.compliance | map: "owasp10" %}
{% assign pci_map = page.compliance | map: "pci" %}
{% assign gdpr_map = page.compliance | map: "gdpr" %}
{% assign iso27001_map = page.compliance | map: "iso27001" %}
{% assign hipaa_map = page.compliance | map: "hipaa" %}

{% assign owasp10 = "OWASP TOP10 -> " | concat: owasp10_map %}
{% assign pci = "PCI-DSS -> " | concat: pci_map %}
{% assign gdpr = "GDPR -> " | concat: gdpr_map %}
{% assign iso27001 = "ISO27001 -> " | concat: iso27001_map %}
{% assign hipaa = "HIPAA -> " | concat: hipaa_map %}

<div class="container-vulnerabilities container clearfix">
	<h1> <a href="/">Vulnerabilities</a> / {{page.name}} </h1>

	<section class="vulnerability">
		<header id="details">
			<div class="piea"></div>


			<div class="info-table-wrapper">
				<p style="text-align: center;">
					<small>{{ page.cvss-vector }}</small>
					<br>
					&darr;
				</p>
				<div class="info-table">

					<div class="row">
						<div class="cell" data-title="Type">
							<b>Severity</b>
						</div>
						<div class="cell" data-title="Value">
							{% assign switch_severity = page.severity %}
							{% case switch_severity %}
							{% when 'low' %}
							<div class="severity-badge s-low">Low</div>
							{% when 'medium' %}
							<div class="severity-badge s-medium">Medium</div>
							{% else %}
							<div class="severity-badge s-high">High</div>
							{% endcase %}
						</div>
					</div>

					<div class="row">
						<div class="cell" data-title="Type">
							<b>CWE Name</b>
						</div>
						<div class="cell" data-title="Value">
							{{ page.name }}
						</div>
					</div>

					<div class="row">
						<div class="cell" data-title="Type">
							<b>CWE ID</b>
						</div>
						<div class="cell" data-title="Value">
							{{ page.cwe-id }}
						</div>
					</div>

					<div class="row">
						<div class="cell" data-title="Type">
							<b>CVSS Score</b>
						</div>
						<div class="cell" data-title="Value">
							{{ page.cvss-score }}
						</div>
					</div>

					<!-- <div class="row">
						<div class="cell" data-title="Type">
							<b>CVSS Vector</b>
						</div>
						<div class="cell" data-title="Value">
							{{ page.cvss-vector }}
						</div>
					</div> -->

					<div class="row">
						<div class="cell" data-title="Type">
							<b>Compliance</b>
						</div>
						<div class="cell" data-title="Value">
							{% if owasp10_map[0] %}
							{{ owasp10 }}
							<br>
							{% endif %}
							{% if pci_map[0] %}
							{{ pci }}
							<br>
							{% endif %}
							{% if hipaa_map[0] %}
							{{ hipaa }}
							<br>
							{% endif %}
							{% if gdpr_map[0] %}
							{{ gdpr }}
							<br>
							{% endif %}
							{% if iso27001_map[0] %}
							{{ iso27001 }}
							{% endif %}
						</div>
					</div>

				</div>
		</header>

		<div class="description">
			{{page}}
		</div>
	</section>
</div>

<script src="/assets/js/circularProgressBar.min.js"></script>
<script src="/assets/js/tabs.js"></script>
<script>
	const LIQUID_CVSS_SEVERITY = '{{ page.severity }}';
	const LIQUID_CVSS_VECTOR = '{{ page.cvss-vector }}';

	/** Parses a CVSS string and returns an object */
	function parseCVSS3(cvss_vector) {
		// CVSS string example: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

		const CVSS_MAP = {
			CVSS: {
				name: "CVSS",
				values: {
					"3.0": "3.0",
				}
			},
			AV: {
				name: "Attack Vector",
				values: {
					N: "Network",
					A: "Adjacent Network",
					L: "Local",
					P: "Physical",
				},
			},
			AC: {
				name: "Attack Complexity",
				values: {
					L: "Low",
					H: "High",
				}
			},
			PR: {
				name: "Privileges Required",
				values: {
					N: "None",
					L: "Low",
					H: "High"
				},
			},
			UI: {
				name: "User Interaction",
				values: {
					N: "None",
					R: "Required",
				},
			},
			S: {
				name: "Scope",
				values: {
					U: "Unchanged",
					C: "Changed"
				}
			},
			C: {
				name: "Confidentiality Impact",
				values: {
					N: "None",
					L: "Low",
					H: "High"
				}
			},
			I: {
				name: "Integrity Impact",
				values: {
					N: "None",
					L: "Low",
					H: "High"
				}
			},
			A: {
				name: "Availability Impact",
				values: {
					N: "None",
					L: "Low",
					H: "High"
				}
			},
		}

		const object = {};
		const splittedString = cvss_vector.split("/");

		splittedString.forEach((i) => {
			const splitted = i.split(":");

			const parsedName = CVSS_MAP[splitted[0]].name;
			const parsedValue = CVSS_MAP[splitted[0]].values[splitted[1]];

			object[parsedName] = parsedValue;
		})

		return object;

	}


	(
		function renderCVSSrows() {
			const parsedCVSS = parseCVSS3(LIQUID_CVSS_VECTOR);
			const table = document.querySelector(".info-table");

			for (const item in parsedCVSS) {
				const row = document.createElement("div");
				const cell1 = document.createElement("div");
				const cell2 = document.createElement("div");

				row.appendChild(cell1);
				row.appendChild(cell2);
				row.className = "row";

				cell1.className = "cell";
				cell1.textContent = item;
				cell1.style.fontWeight = "700";
				cell1.setAttribute("data-title", "Type");

				cell2.className = "cell";
				cell2.textContent = parsedCVSS[item];
				cell2.setAttribute("data-title", "Value");

				table.appendChild(row);
			}
		}
	)();

	const SEVERITY_COLORS = {
		low: '#3e8c3f',
		medium: '#d9850f',
		high: '#bf3737',
	}

	window.addEventListener('DOMContentLoaded', () => {
		const score = "{{ score }}" / 10 * 100;
		new CircularProgressBar({
			percent: score,
			pie: 'piea',
			color: SEVERITY_COLORS[LIQUID_CVSS_SEVERITY]
		});
	});

</script>